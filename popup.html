<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matcha - Job Matching</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <!-- Sign In Screen (shown when not logged in) -->
        <div id="signInScreen" class="sign-in-screen" style="display: none;">
            <div class="sign-in-content">
                <h1><img src="assets/icon.png" alt="Matcha"
                        style="width: 32px; height: 32px; vertical-align: middle; margin-right: 8px;">Matcha</h1>
                <p>Analyze job descriptions against your CV and get tailored suggestions.</p>

                <div class="features-list">
                    <div class="feature">‚úì AI-powered job matching</div>
                    <div class="feature">‚úì Tailored CV bullets</div>
                    <div class="feature">‚úì Job application tracker</div>
                </div>

                <button id="googleSignInBtn" class="btn-google">
                    <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z"
                            fill="#4285F4" />
                        <path
                            d="M9.003 18c2.43 0 4.467-.806 5.956-2.18l-2.909-2.26c-.806.54-1.836.86-3.047.86-2.344 0-4.328-1.584-5.036-3.711H.96v2.332C2.44 15.983 5.485 18 9.003 18z"
                            fill="#34A853" />
                        <path
                            d="M3.964 10.712c-.18-.54-.282-1.117-.282-1.71 0-.593.102-1.17.282-1.71V4.96H.957C.347 6.175 0 7.55 0 9.002c0 1.452.348 2.827.957 4.042l3.007-2.332z"
                            fill="#FBBC05" />
                        <path
                            d="M9.003 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.464.891 11.428 0 9.002 0 5.485 0 2.44 2.017.96 4.958L3.967 7.29c.708-2.127 2.692-3.71 5.036-3.71z"
                            fill="#EA4335" />
                    </svg>
                    Sign in with Google
                </button>

                <p class="sign-in-note">Free: 10 analyses/month</p>
            </div>
        </div>

        <!-- Main App (shown when logged in) -->
        <div id="mainApp">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <h1><img src="assets/icon.png" alt="Matcha"
                            style="width: 24px; height: 24px; vertical-align: middle; margin-right: 6px;">Matcha</h1>
                    <div id="userInfo" class="user-info">
                        <img id="userAvatar" src="" alt="" class="user-avatar">
                        <span id="userName"></span>
                    </div>
                </div>
                <div class="header-actions">
                    <button id="settingsBtn" class="btn-icon" title="Settings">‚öôÔ∏è</button>
                    <button id="openTrackerBtn" class="btn-secondary" title="Open Job Tracker">üìä Tracker</button>
                    <button id="uploadCVBtn" class="btn-secondary">üìÑ CV</button>
                </div>
            </header>

            <!-- Usage Bar -->
            <div id="usageBar" class="usage-bar">
                <div class="usage-text">
                    <span id="usageCount">0/10</span> analyses used
                </div>
                <div class="usage-progress">
                    <div id="usageProgress" class="usage-progress-bar" style="width: 0%"></div>
                </div>
            </div>

            <!-- CV Upload Section (hidden file input) -->
            <input type="file" id="cvFileInput" accept=".pdf,.txt" style="display: none;">

            <!-- Main Content -->
            <main class="main-content">
                <!-- Current JD Section -->
                <section id="currentJDSection" class="section">
                    <h2>Current Job Description</h2>

                    <!-- Page Info -->
                    <div id="pageInfo" class="page-info">
                        <div id="pageTitle" class="page-title">No page loaded</div>
                        <div id="pageUrl" class="page-url"></div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="action-buttons">
                        <button id="analyzeBtn" class="btn-primary">üîç Analyze Current Page</button>
                        <button id="saveToTrackerBtn" class="btn-secondary" disabled>üíæ Save to Tracker</button>
                        <button id="copyBulletsBtn" class="btn-secondary" disabled>üìã Copy Tailored Bullets</button>
                    </div>

                    <!-- Loading State -->
                    <div id="loadingState" class="loading-state" style="display: none;">
                        <div class="spinner"></div>
                        <p>Analyzing job description...</p>
                    </div>

                    <!-- Error State -->
                    <div id="errorState" class="error-state" style="display: none;">
                        <p class="error-message"></p>
                    </div>

                    <!-- Analysis Results -->
                    <div id="analysisResults" class="analysis-results" style="display: none;">
                        <!-- Match Score -->
                        <div class="match-score-container">
                            <div class="match-score">
                                <span id="matchScore" class="score-value">--</span>
                                <span class="score-label">Match Score</span>
                            </div>
                            <div id="matchLabel" class="match-label">--</div>
                        </div>

                        <!-- Match Explanation -->
                        <div class="explanation-section">
                            <h3>Match Explanation</h3>
                            <div class="explanation-items">
                                <div class="explanation-item">
                                    <span class="explanation-icon">üí™</span>
                                    <div>
                                        <strong>Strength:</strong>
                                        <p id="strengthText">--</p>
                                    </div>
                                </div>
                                <div class="explanation-item">
                                    <span class="explanation-icon">‚ö†Ô∏è</span>
                                    <div>
                                        <strong>Risk:</strong>
                                        <p id="riskText">--</p>
                                    </div>
                                </div>
                                <div class="explanation-item">
                                    <span class="explanation-icon">üí°</span>
                                    <div>
                                        <strong>Suggestion:</strong>
                                        <p id="suggestionText">--</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Gap Analysis -->
                        <div class="gap-analysis-section">
                            <h3>Gap Analysis</h3>
                            <ul id="gapAnalysisList" class="gap-list"></ul>
                        </div>

                        <!-- Tailored Bullets -->
                        <div class="tailored-bullets-section">
                            <h3>Tailored CV Bullets</h3>
                            <ul id="tailoredBulletsList" class="bullets-list"></ul>
                        </div>
                    </div>
                </section>
            </main>

            <!-- Settings Modal -->
            <div id="settingsModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Settings</h2>
                        <button id="closeSettingsBtn" class="btn-close">√ó</button>
                    </div>
                    <div class="modal-body">
                        <form id="settingsForm">
                            <!-- Account Section -->
                            <div class="form-group">
                                <h3 style="margin-top: 0; margin-bottom: 12px;">üë§ Account</h3>
                                <div id="accountInfo" class="account-info">
                                    <img id="settingsUserAvatar" src="" alt="" class="user-avatar-large">
                                    <div class="account-details">
                                        <span id="settingsUserName" class="account-name"></span>
                                        <span id="settingsUserEmail" class="account-email"></span>
                                    </div>
                                </div>
                                <button type="button" id="signOutBtn" class="btn-secondary btn-danger-outline"
                                    style="margin-top: 12px;">Sign Out</button>
                            </div>

                            <div class="form-group"
                                style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb;">
                                <label
                                    style="display: flex; align-items: center; justify-content: space-between; cursor: pointer;">
                                    <span>Show floating button on pages</span>
                                    <input type="checkbox" id="floatingButtonEnabled" checked>
                                </label>
                                <small style="display: block; margin-top: 8px; color: #666;">
                                    Toggle the floating button that appears on job pages instantly.
                                </small>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn-primary">Save Settings</button>
                            </div>
                        </form>

                        <div class="cv-status">
                            <h3>üìÑ CV Status</h3>
                            <p id="cvStatus">No CV uploaded</p>
                            <button id="clearCVBtn" class="btn-secondary" style="display: none;">Clear CV</button>
                        </div>

                        <div class="usage-stats-section"
                            style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb;">
                            <h3>üìä Usage This Month</h3>
                            <div id="settingsUsageInfo" class="usage-stats">
                                <p>Loading usage...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script type="module" src="popup.js"></script>
</body>

</html>